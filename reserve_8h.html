<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>osurs: include/osurs/reserve.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">osurs
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_e18da3170263ec3a51f2200942d5dc3d.html">osurs</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">reserve.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Connection routing, checking seat availability and reservation.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;limits.h&gt;</code><br />
<code>#include &lt;<a class="el" href="network_8h_source.html">osurs/network.h</a>&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for reserve.h:</div>
<div class="dyncontent">
<div class="center"><img src="reserve_8h__incl.png" border="0" usemap="#ainclude_2osurs_2reserve_8h" alt=""/></div>
<map name="ainclude_2osurs_2reserve_8h" id="ainclude_2osurs_2reserve_8h">
<area shape="rect" title="Connection routing, checking seat availability and reservation." alt="" coords="15,5,189,32"/>
<area shape="rect" title=" " alt="" coords="5,80,76,107"/>
<area shape="rect" href="network_8h.html" title="Network for reservation optmization." alt="" coords="100,80,227,107"/>
<area shape="rect" href="types_8h.html" title="Data types of osurs." alt="" coords="109,155,218,181"/>
<area shape="rect" title=" " alt="" coords="128,229,199,256"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="reserve_8h__dep__incl.png" border="0" usemap="#ainclude_2osurs_2reserve_8hdep" alt=""/></div>
<map name="ainclude_2osurs_2reserve_8hdep" id="ainclude_2osurs_2reserve_8hdep">
<area shape="rect" title="Connection routing, checking seat availability and reservation." alt="" coords="181,5,355,32"/>
<area shape="rect" href="import_8c.html" title="Import a network file." alt="" coords="5,80,120,107"/>
<area shape="rect" href="main_8c.html" title="Osurs CLI (tbd)." alt="" coords="145,80,234,107"/>
<area shape="rect" href="connection_8c.html" title="Routing connections between nodes on the network without transfers." alt="" coords="258,80,438,107"/>
<area shape="rect" href="reservation_8c.html" title="Placing reservations for found connections." alt="" coords="462,80,645,107"/>
</map>
</div>
</div>
<p><a href="reserve_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abd0ae8c40d931cf153e111b813c203b8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="types_8h.html#ac7a41ce4d89ee6775b80355ab2abccbd">Connection</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="reserve_8h.html#abd0ae8c40d931cf153e111b813c203b8">new_connection</a> (const <a class="el" href="types_8h.html#a9fa1463f3b93a55de4cf83e519c4473c">Node</a> *orig, const <a class="el" href="types_8h.html#a9fa1463f3b93a55de4cf83e519c4473c">Node</a> *dest, int time)</td></tr>
<tr class="memdesc:abd0ae8c40d931cf153e111b813c203b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create connection between nodes.  <a href="reserve_8h.html#abd0ae8c40d931cf153e111b813c203b8">More...</a><br /></td></tr>
<tr class="separator:abd0ae8c40d931cf153e111b813c203b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae27007bb20595b7acda60ae67ce70f03"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="reserve_8h.html#ae27007bb20595b7acda60ae67ce70f03">check_connection</a> (<a class="el" href="types_8h.html#ac7a41ce4d89ee6775b80355ab2abccbd">Connection</a> *connection, int seats, int *trip_count)</td></tr>
<tr class="memdesc:ae27007bb20595b7acda60ae67ce70f03"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if seats are available in connection.  <a href="reserve_8h.html#ae27007bb20595b7acda60ae67ce70f03">More...</a><br /></td></tr>
<tr class="separator:ae27007bb20595b7acda60ae67ce70f03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97bd8d6896b77a9156952e3d5487e987"><td class="memItemLeft" align="right" valign="top"><a class="el" href="types_8h.html#ac7a41ce4d89ee6775b80355ab2abccbd">Connection</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="reserve_8h.html#a97bd8d6896b77a9156952e3d5487e987">select_connection</a> (<a class="el" href="types_8h.html#ac7a41ce4d89ee6775b80355ab2abccbd">Connection</a> *connection, int seats)</td></tr>
<tr class="memdesc:a97bd8d6896b77a9156952e3d5487e987"><td class="mdescLeft">&#160;</td><td class="mdescRight">Selects the best connection.  <a href="reserve_8h.html#a97bd8d6896b77a9156952e3d5487e987">More...</a><br /></td></tr>
<tr class="separator:a97bd8d6896b77a9156952e3d5487e987"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa779258c97d35a2fafe85fad7440f371"><td class="memItemLeft" align="right" valign="top"><a class="el" href="types_8h.html#a8be82d57518f84df3ceb7a5dce2fce0c">Reservation</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="reserve_8h.html#aa779258c97d35a2fafe85fad7440f371">new_reservation</a> (<a class="el" href="types_8h.html#ac7a41ce4d89ee6775b80355ab2abccbd">Connection</a> *connection, int seats)</td></tr>
<tr class="memdesc:aa779258c97d35a2fafe85fad7440f371"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new reservation.  <a href="reserve_8h.html#aa779258c97d35a2fafe85fad7440f371">More...</a><br /></td></tr>
<tr class="separator:aa779258c97d35a2fafe85fad7440f371"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47a02bf1a7474cbfd25eb60a235c088b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="reserve_8h.html#a47a02bf1a7474cbfd25eb60a235c088b">delete_connection</a> (<a class="el" href="types_8h.html#ac7a41ce4d89ee6775b80355ab2abccbd">Connection</a> *connection)</td></tr>
<tr class="memdesc:a47a02bf1a7474cbfd25eb60a235c088b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delete a connection.  <a href="reserve_8h.html#a47a02bf1a7474cbfd25eb60a235c088b">More...</a><br /></td></tr>
<tr class="separator:a47a02bf1a7474cbfd25eb60a235c088b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Connection routing, checking seat availability and reservation. </p>
<p>Simple connection routing alogrithm without transfers. After checking seat availability in connections reservations can be booked on the network.</p>
<dl class="section note"><dt>Note</dt><dd>There are already powerful routing algorithms for public transport, so the algorithm included here is minimal and only serves to book reservations on already known/found connections to the right segments of the trips (without transfers).</dd></dl>
<dl class="section date"><dt>Date</dt><dd>: 2022-07-12 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>: Merlin Unterfinger </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ae27007bb20595b7acda60ae67ce70f03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae27007bb20595b7acda60ae67ce70f03">&#9670;&nbsp;</a></span>check_connection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int check_connection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#ac7a41ce4d89ee6775b80355ab2abccbd">Connection</a> *&#160;</td>
          <td class="paramname"><em>connection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>seats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>trip_count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if seats are available in connection. </p>
<p>Check a connection if the desired number of seats is available. This is important since reservations can change or avoid double booking of a serached connection.</p>
<dl class="section note"><dt>Note</dt><dd>This function is called internally by new_reservation(Connection).</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">connection</td><td>The queried connection to check. </td></tr>
    <tr><td class="paramname">seats</td><td>The number of seats to check. </td></tr>
    <tr><td class="paramname">trip_count</td><td>The trip number on the route, needed for getting the reserved count. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 0 if failure and 1 if success. </dd></dl>

</div>
</div>
<a id="a47a02bf1a7474cbfd25eb60a235c088b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47a02bf1a7474cbfd25eb60a235c088b">&#9670;&nbsp;</a></span>delete_connection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void delete_connection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#ac7a41ce4d89ee6775b80355ab2abccbd">Connection</a> *&#160;</td>
          <td class="paramname"><em>connection</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Delete a connection. </p>
<p>Frees the memory from a connection chain on the heap.</p>
<dl class="section note"><dt>Note</dt><dd>This function has to be called for every queried connection to prevent memory leaks.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">connection</td><td>The connection chain to delete. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="abd0ae8c40d931cf153e111b813c203b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd0ae8c40d931cf153e111b813c203b8">&#9670;&nbsp;</a></span>new_connection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#ac7a41ce4d89ee6775b80355ab2abccbd">Connection</a>* new_connection </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="types_8h.html#a9fa1463f3b93a55de4cf83e519c4473c">Node</a> *&#160;</td>
          <td class="paramname"><em>orig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="types_8h.html#a9fa1463f3b93a55de4cf83e519c4473c">Node</a> *&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create connection between nodes. </p>
<p>Searches connections between nodes on the network considering a departure time. If more than one connection is possible between to nodes on the network, a connection chain is created. In a connection chain, the .last property of the connection structure points to the last connection or NULL if it is the root of the chain. Identically, the .next property points to the next connection or to NULL if it is the end of the chain.</p>
<dl class="section note"><dt>Note</dt><dd>Queried connections are not stored on the network and must be released individually to prevent a memory leak (<a class="el" href="reserve_8h.html#a47a02bf1a7474cbfd25eb60a235c088b" title="Delete a connection.">delete_connection(Connection*)</a>).</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">orig</td><td>Origin node in network for connection. </td></tr>
    <tr><td class="paramname">dest</td><td>Destination node in network for connection. </td></tr>
    <tr><td class="paramname">time</td><td>The departure time in seconds after midnight (00:00:00). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a pointer to a connection chain or NULL if no connection was found. </dd></dl>

</div>
</div>
<a id="aa779258c97d35a2fafe85fad7440f371"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa779258c97d35a2fafe85fad7440f371">&#9670;&nbsp;</a></span>new_reservation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#a8be82d57518f84df3ceb7a5dce2fce0c">Reservation</a>* new_reservation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#ac7a41ce4d89ee6775b80355ab2abccbd">Connection</a> *&#160;</td>
          <td class="paramname"><em>connection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>seats</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a new reservation. </p>
<p>Books a connection on the network, if the desired seats are available. If enough seats are available the reservation counts of the corresponding trip on the stops of the routes are increased and a new reservation is allocated and connected to the network.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">connection</td><td>The connection to reserve. </td></tr>
    <tr><td class="paramname">seats</td><td>The number of seats to reserve. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a reservation or null if no seats are available. </dd></dl>

</div>
</div>
<a id="a97bd8d6896b77a9156952e3d5487e987"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97bd8d6896b77a9156952e3d5487e987">&#9670;&nbsp;</a></span>select_connection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#ac7a41ce4d89ee6775b80355ab2abccbd">Connection</a>* select_connection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#ac7a41ce4d89ee6775b80355ab2abccbd">Connection</a> *&#160;</td>
          <td class="paramname"><em>connection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>seats</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Selects the best connection. </p>
<p>Chooses the best connection based on arrival time and seat availablity.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">connection</td><td>Connection results from <a class="el" href="reserve_8h.html#abd0ae8c40d931cf153e111b813c203b8" title="Create connection between nodes.">new_connection()</a>. </td></tr>
    <tr><td class="paramname">seats</td><td>The number of seats that should be available on the connection. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The shifted pointer to the best connection (Connection*) or NULL if no suitable connection is found. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
